function fig = marlin_summary_control()
% This is the machine-generated representation of a Handle Graphics object
% and its children.  Note that handle values may change when these objects
% are re-created. This may cause problems with any callbacks written to
% depend on the value of the handle at the time the object was saved.
% This problem is solved by saving the output as a FIG-file.
%
% To reopen this object, just type the name of the M-file at the MATLAB
% prompt. The M-file and its associated MAT-file must be on your path.
% 
% NOTE: certain newer features in MATLAB may not have been saved in this
% M-file due to limitations of this format, which has been superseded by
% FIG-files.  Figures which have been annotated using the plot editor tools
% are incompatible with the M-file/MAT-file format, and should be saved as
% FIG-files.
tt=findobj('tag','control_panel');
  set(tt,'close','');
tt=findobj('tag','marlin_sum_plot');
  set(tt,'close','');
close all
clear global q summ
  global q summ
if isempty(summ)
[fname,pname]=  uigetfile('*.mat','Choose Marlin Summary File');
load([pname fname]);
	 summ.pathname=pname;
	 summ.filename=fname;
	 q.xmin=min(summ.timevec);
	 q.xmax=max(summ.timevec);
end
q.sum_series=summ.seriesname;
q.xplotseries=q.sum_series(1);
q.current_plots(1).name=[];
q.current_plots(1).series=[];
q.current_plots(1).lin=[];
q.current_plots(1).norm=[];
q.nplots=0;

%load marlin_config
q.hand.controlfig = figure(23);
set(23,'Color',[0.8 0.8 0.8], ...
	'FileName','C:\work\m99b\m_files\marlin_summary_control.m', ...
	'MenuBar','none', ...
	'Name','Marlin Plot Control Panel ', ...
	'close','disp(''Sorry, You can not close this window!'')',...   
	'NumberTitle','off', ...
	'PaperUnits','points', ...
	'resize','off',...
	'Units','points', ...
	'Position',[42 251 296 258], ...
	'Tag','control_panel', ...
	'ToolBar','none');
h0=q.hand.controlfig;
q.hand.allser = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'Position',[15.51724137931035 15.51724137931035 77.58620689655174 201.7241379310345], ...
	'String',q.sum_series, ...
	'Style','listbox', ...
	'Tag','all_series', ...
	'max',100,...
    'buttondownf','update_series(6)',...		   
	'Value',1);
h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[15.51724137931035 232.7586206896552 77.58620689655174 15.51724137931035], ...
	'String','Add to Fig ==>', ...
	'Tag','add_to_fig', ...
	'Callback','update_series(1)',...		   
	'TooltipString','Select and Click here to add series to plot');
h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[ 108.6207  232.7586   77.5862   15.5172], ...
	'String','<== Send Back', ...
	'Tag','send_back', ...
	'Callback','update_series(2)',...		   
	'TooltipString','Select series and click here to remove series from plot');
q.hand.plotser = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'Max',1, ...
	'Position',[ 108.6207   75.5172   77.5862  141.7241], ...
	'String',q.current_plots.name, ...
    'callback','update_series(13)',...
	'Style','listbox', ...
	'Tag','plot_series');

q.hand.lin= uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'Max',1, ...
	'Position',[ 108.6207   35.5172   35  12], ...
	'String','lin',...
    'value',1,...
	'Style','radio', ...
			   'tooltip','Linear y-axis',...
			   'callback','update_series(14)',...
	'Tag','linbox');
q.hand.log = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'Max',1, ...
	'Position',[ 151   35.5172   35  12], ...
	'String','log',...
	'Style','radio', ...
			   'callback','update_series(15)',...
			   'tooltip','Logarythmic y-axis',...
	'Tag','logbox');
q.hand.norm = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'Max',1, ...
	'Position',[ 108.6207   15.5172   35  12], ...
			   'value',1,...
	'String','norm',...
	'Style','radio', ...
			   'callback','update_series(16)',...
			   'tooltip','Normal y-axis',...
	'Tag','normalbox');
q.hand.rev = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'Max',1, ...
	'Position',[ 151   15.5172   35  12], ...
	'String','rev',...
	'Style','radio', ...
	'callback','update_series(17)',...
			   'tooltip','Reverse the direction of the y-axis',...
	'Tag','reversebox');

h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 30.51724137931035 86.55172413793105 15.55172413793105], ...
	'String',['Reload'], ...
	'Tag','reload', ...
	'Callback','update_series(10)',...		   
	'TooltipString','Redraw the figure with the current settings');

h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 10.51724137931035 86.55172413793105 15.55172413793105], ...
	'String',['Redraw'], ...
	'Tag','redrawit', ...
	'Callback','plot_marlin_sum',...		   
	'TooltipString','Redraw the figure with the current settings');
h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 90.51724137931035 86.55172413793105 15.55172413793105], ...
	'String',['zoom in time'], ...
	'Tag','zoomin', ...
	'Callback','update_series(8)',...		   
	'TooltipString','Select time range to zoom in on');
h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 70.51724137931035 86.55172413793105 15.55172413793105], ...
	'String',['zoom back'], ...
	'Tag','zoomback', ...
	'Callback','update_series(11)',...		   
	'TooltipString','Zoom to previous scale');
h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 50.51724137931035 86.55172413793105 15.55172413793105], ...
	'String',['zoom out'], ...
	'Tag','zoomout', ...
	'Callback','update_series(9)',...		   
	'TooltipString','Select time range to zoom in on');
q.hand.xseries = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 217.2413793103449 86.55172413793105 15.51724137931035], ...
	'String',q.sum_series, ...
	'Style','popupmenu', ...
	'Tag','xplotseries', ...
	'callback','update_series(3)',...		   
	'Value',1);
h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 232.7586206896552 86.55172413793105 15.51724137931035], ...
	'String','x-series', ...
	'Style','text', ...
	'Tag','StaticText1', ...
	'TooltipString','Series to plot all data against');
h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8827586206897 185.5862068965518 86.55172413793105 15.51724137931035], ...
	'String','X-min', ...
	'Style','text', ...
	'Tag','StaticText2', ...
	'TooltipString','Minimum time to plot');
q.hand.xmax = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 139.6551724137931 86.55172413793105 15.51724137931035], ...
	'String','X-max', ...
	'Style','text', ...
	'Tag','StaticText2', ...
	'TooltipString','Maximum Time to Plot');
q.hand.xmin = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 170.6896551724138 86.55172413793105 15.51724137931035], ...
	'Style','edit', ...
    'string', [datestr(q.xmin(length(q.xmin)),6) ' ' datestr(q.xmin(length(q.xmin)),15)], ...
    'callback','update_series(4)',...
	'Tag','xmin');
h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[200.8620689655173 124.1379310344828 86.55172413793105 15.51724137931035], ...
	'Style','edit', ...
    'string',[datestr(q.xmax(length(q.xmax)),6) ' ' datestr(q.xmax(length(q.xmax)),15)], ...
    'callback','update_series(5)',...
	'Tag','xmax');
q.hand.datafig=figure(29);
set(29,'Name','Marlin Summary Data', ...
	'NumberTitle','off', ...
	'close','disp(''Sorry, You can not close this window!'')',...   
	'Tag','marlin_sum_plot', ...
	'ToolBar','none');
h_sum=q.hand.datafig;
h1=uimenu('parent',h_sum,'label','Quit',... 
   'callback','update_series(99)')
h1=uimenu('parent',h_sum,'label','ZOOM');
uimenu('parent',h1,'label','Zoom in time','callback', ... 
	  'update_series(8)')
uimenu('parent',h1,'label','Zoom back once','callback', ... 
		  'update_series(11)')
uimenu('parent',h1,'label','Zoom Out','callback', ... 
		  'update_series(9)')
h2=uimenu('parent',h1,'label','Matlab');
uimenu('parent',h2','label','zoom vertical (yon)','callback', ... 
		  'zoom yon')
uimenu('parent',h2','label','regular zoom','callback', ... 
		  'zoom on')
uimenu('parent',h2','label','zoom horizontal (xon)','callback', ... 
		  'zoom xon')
h1=uimenu('parent',h_sum,'label','Reload data','callback','update_series(10)');
if nargout > 0, fig = h0; end


