function run_chambackup(frompath,topath,dataprefix,polltime)% function run_chambackup(frompath,topath,dataprefix);% This is the top-level script for the back-up computer....% frompath = '\\dirigible\data\eq08\Chameleon\Raw\';% directory in which the Marlin data is stored...% topath = '\\baltic_data\data\eq08\data\chameleon\raw\';% directory where the Marlin data is backed up to...% this is the prefix of the datafiles% dataprefix='st10';% this how often the daq computer is polled in seconds.% polltime = 30;% $Revision: 1.6 $ $Date: 2010/11/20 00:39:29 $ $Author: aperlin $	% Check that the frompath exists...if ~exist(frompath)  error(['The source directory: ' frompath ' can''t be found.  Check',  ...          'that the machine has been mounted']);end;if ~exist(topath)  error(['The source directory: ' topath ' can''t be found. Create',  ...          ' the directory']);end;% while 1  fprintf(1,'Polling for new files in %s\n',frompath );  % first thing is to compare the two directory trees and make sure  % they are identical.  If not, do some copying....  % We can't automate because of the annoying naming convention  % MarlCham files%   fromp = [frompath '/raw/'];%   top = [topath '/raw/'];  fromp = frompath;  top = topath;  fromdir = [fromp dataprefix '*'];  todir = [top dataprefix '*'];  % files are sequential therefore lets strip the sequence numbers  % to compare....  [d dd]=dirdiff(fromdir,todir,0,1);  copyall(fromp,top,d);  fprintf(1,'\nWaiting %d seconds to poll again; on file: %s\n',...      polltime,dd(end).name);  disp(datestr(now))%   for j=1:polltime%     fprintf(1,'-');%     pause(1); %   end;%   fprintf('\n');% end;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%function copyall(fromdir,todir,names)  for i=1:length(names);    from = [fromdir '/' names{i}];    to = [todir '/'];    fprintf(1,'Copying %s to %s\n',from,to);    [status,msg]=copyfile(from,to);    if ~status      error(msg);    end;  end;  